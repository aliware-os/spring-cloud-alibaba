<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.47" />
    <meta name="description" content="Documentation for Spring Cloud Alibaba">
<meta name="author" content="Aliware Docs">

    <link rel="shortcut icon" href="/spring-cloud-alibaba/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/spring-cloud-alibaba/images/favicon.png" type="image/x-icon" />
    <title>Nacos Config Example :: Documentation for Spring Cloud Alibaba</title>

    
    <link href="/spring-cloud-alibaba/css/nucleus.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/fontawesome-all.min.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/hybrid.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/featherlight.min.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/perfect-scrollbar.min.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/auto-complete.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/theme.css?1542024317" rel="stylesheet">
    <link href="/spring-cloud-alibaba/css/hugo-theme.css?1542024317" rel="stylesheet">
    
      <link href="/spring-cloud-alibaba/css/theme-blue.css?1542024317" rel="stylesheet">
    

    <script src="/spring-cloud-alibaba/js/jquery-2.x.min.js?1542024317"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/spring-cloud-alibaba/en/quick_start/nacos-config/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://getgrav.org">
  <svg id="grav-logo" width="100%" height="100%" viewBox="0 0 504 140" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
    <path d="M235.832,71.564l-7.98,-0.001c-1.213,0.001 -2.197,0.987 -2.197,2.204l0,15.327l-0.158,0.132c-4.696,3.962 -10.634,6.14 -16.719,6.14c-14.356,0 -26.034,-11.68 -26.034,-26.037c0,-14.358 11.678,-26.035 26.034,-26.035c5.582,0 10.919,1.767 15.437,5.113c0.877,0.649 2.093,0.56 2.866,-0.211l5.69,-5.69c0.444,-0.442 0.675,-1.055 0.639,-1.681c-0.034,-0.627 -0.336,-1.206 -0.828,-1.597c-6.76,-5.363 -15.214,-8.314 -23.805,-8.314c-21.18,0 -38.414,17.233 -38.414,38.415c0,21.183 17.234,38.415 38.414,38.415c10.937,0 21.397,-4.705 28.698,-12.914c0.358,-0.403 0.556,-0.921 0.556,-1.46l0,-19.603c0,-1.217 -0.985,-2.203 -2.2,-2.203"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M502.794,34.445c-0.408,-0.616 -1.1,-0.989 -1.838,-0.989l-8.684,0c-0.879,0 -1.673,0.522 -2.022,1.329l-24.483,56.839l-24.92,-56.852c-0.352,-0.799 -1.142,-1.316 -2.012,-1.316l-8.713,0c-0.744,0 -1.44,0.373 -1.843,0.995c-0.408,0.623 -0.476,1.408 -0.174,2.09l30.186,68.858c0.352,0.799 1.143,1.317 2.017,1.317l10.992,0c0.879,0 1.673,-0.527 2.021,-1.329l29.655,-68.861c0.289,-0.68 0.222,-1.461 -0.182,-2.081"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M388.683,34.772c-0.353,-0.798 -1.142,-1.316 -2.017,-1.316l-10.988,0c-0.879,0 -1.673,0.522 -2.021,1.329l-29.655,68.861c-0.294,0.675 -0.226,1.46 0.182,2.077c0.407,0.619 1.096,0.993 1.838,0.993l8.684,0c0.879,0 1.673,-0.526 2.022,-1.329l24.478,-56.842l24.92,56.854c0.353,0.798 1.143,1.317 2.013,1.317l8.717,0c0.744,0 1.44,-0.374 1.843,-0.993c0.408,-0.624 0.471,-1.41 0.174,-2.094l-30.19,-68.857Z"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M309.196,81.525l0.476,-0.229c8.675,-4.191 14.279,-13.087 14.279,-22.667c0,-13.881 -11.295,-25.174 -25.176,-25.174l-31.863,0c-1.214,0 -2.199,0.988 -2.199,2.202l0,68.855c0,1.219 0.985,2.204 2.199,2.204l7.979,0c1.214,0 2.2,-0.985 2.2,-2.204l0,-58.679l21.684,0c7.059,0 12.799,5.739 12.799,12.796c0,5.885 -3.996,10.989 -9.728,12.408c-1.032,0.261 -2.064,0.393 -3.071,0.393l-7.977,0c-0.829,0 -1.585,0.467 -1.959,1.205c-0.378,0.74 -0.305,1.625 0.187,2.296l22.62,30.884c0.412,0.566 1.07,0.901 1.771,0.901l9.915,0c0.827,0 1.587,-0.467 1.96,-1.207c0.378,-0.742 0.302,-1.629 -0.186,-2.296l-15.91,-21.688Z"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M107.191,80.969c-7.255,-4.794 -11.4,-8.845 -15.011,-16.109c-2.47,4.977 -8.236,12.376 -17.962,18.198c-4.856,15.106 -27.954,44.015 -35.43,39.916c-2.213,-1.212 -2.633,-2.808 -2.133,-4.456c0.536,-4.129 9.078,-13.62 9.078,-13.62c0,0 0.18,1.992 2.913,6.187c-3.609,-11.205 5.965,-25.031 8.5,-29.738c3.985,-1.269 4.274,-6.387 4.274,-6.387c0.255,-7.909 -3.278,-13.635 -6.701,-17.059c2.459,3.002 3.255,7.539 3.372,11.694l0,0.023c0.012,0.469 0.012,0.93 0.011,1.39c-0.117,3.439 -1.157,8.19 -3.383,8.19l0.006,0.03c-2.289,-0.098 -5.115,0.391 -7.639,1.18l-5.582,1.334c0,0 2.977,-0.136 4.584,1.252c-1.79,2.915 -5.769,6.533 -10.206,8.588c-6.457,2.995 -8.312,-2.964 -5.034,-6.838c0.805,-0.946 1.618,-1.745 2.387,-2.399c-0.495,-0.513 -0.807,-1.198 -0.889,-2.068c-0.001,-0.005 -0.004,-0.009 -0.005,-0.013c-0.45,-1.977 -0.202,-4.543 2.596,-8.623c0.551,-0.863 1.214,-1.748 2.007,-2.647c0.025,-0.031 0.046,-0.059 0.072,-0.089c0.034,-0.042 0.072,-0.08 0.108,-0.121c0.02,-0.023 0.039,-0.045 0.059,-0.068c0.2,-0.228 0.413,-0.45 0.639,-0.663c3.334,-3.414 8.599,-6.966 16.897,-10.152c9.675,-14.223 13.219,-16.89 13.219,-16.89c1.071,-1.096 2.943,-2.458 3.632,-2.805c-5.053,-8.781 -6.074,-21.158 -4.75,-24.493c-0.107,0.18 -0.206,0.365 -0.287,0.556c0.49,-1.143 0.819,-1.509 1.328,-2.111c1.381,-1.632 6.058,-2.488 7.737,0.971c0.895,1.844 1.063,4.232 1.034,6.023c-3.704,-0.193 -7.063,4.036 -7.063,4.036c0,0 3.067,-1.448 6.879,-1.473c0,0 1.015,0.883 2.283,2.542c-1.712,3.213 -4.524,10.021 -2.488,17.168c0.338,1.408 0.849,2.619 1.483,3.648c0.024,0.045 0.044,0.089 0.069,0.135c0.051,0.066 0.096,0.122 0.144,0.183c3.368,5.072 9.542,5.665 9.542,5.665c-2.906,-1.45 -5.274,-3.76 -6.816,-6.56c-0.8,-1.498 -1.291,-2.762 -1.592,-3.761c-1.636,-6.313 0.771,-9.999 2.149,-12.471c3.17,-4.917 8.944,-7.893 15.151,-7.185c8.712,0.995 14.968,8.862 13.973,17.571c-0.608,5.321 -3.781,9.723 -8.142,12.117c1.049,2.839 -0.073,6.28 -0.073,6.28c2.642,3.323 2.758,5.238 2.667,7.017c-3.357,-0.565 -6.618,1.701 -6.618,1.701c0,0 6.476,-1.546 10.238,1.81c2.446,2.631 4.078,5.009 5.051,6.766c1.393,2.505 7.859,2.683 7.123,7.188c-0.737,4.499 -5.669,4.542 -13.401,-0.56M69.571,0c-38.424,0 -69.571,31.148 -69.571,69.567c0,38.422 31.147,69.573 69.571,69.573c38.42,0 69.568,-31.151 69.568,-69.573c0,-38.42 -31.148,-69.567 -69.568,-69.567"
      style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M73.796,51.693c0.813,-0.814 0.813,-2.134 0,-2.947c-0.815,-0.814 -2.133,-0.814 -2.947,0c-0.815,0.813 -0.815,2.133 0,2.947c0.814,0.813 2.132,0.813 2.947,0" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M66.445,53.149c-0.814,0.813 -0.814,2.133 0,2.947c0.813,0.814 2.133,0.814 2.947,0c0.813,-0.814 0.813,-2.134 0,-2.947c-0.814,-0.813 -2.134,-0.813 -2.947,0" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M79.231,54.233c-1.274,-1.274 -3.339,-1.272 -4.611,0l-2.713,2.712c-1.274,1.275 -1.274,3.339 0,4.612l2.978,2.978c1.274,1.275 3.338,1.274 4.611,0l2.712,-2.712c1.274,-1.274 1.274,-3.339 0,-4.612l-2.977,-2.978Z" style="fill:#000;fill-rule:nonzero;"></path>
    <path d="M95.759,41.445c-2.151,-2.578 1.869,-7.257 4.391,-4.463c4.645,5.148 -2.237,7.041 -4.391,4.463M105.004,44.132c3.442,-6.553 -1.427,-10.381 -4.773,-13.523c-5.36,-5.039 -10.706,-7.217 -16.811,-0.241c-6.102,6.977 -2.226,15.068 3.356,19.061c5.584,3.994 14.782,1.255 18.228,-5.297"
      style="fill:#000;fill-rule:nonzero;"></path>
  </svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/spring-cloud-alibaba/js/lunr.min.js?1542024317"></script>
<script type="text/javascript" src="/spring-cloud-alibaba/js/auto-complete.js?1542024317"></script>
<script type="text/javascript">
    
        var baseurl = "\/spring-cloud-alibaba\/en";
    
</script>
<script type="text/javascript" src="/spring-cloud-alibaba/js/search.js?1542024317"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/roadmap/" title="Roadmap" class="dd-item 
        
        
        
        ">
      <a href="/spring-cloud-alibaba/en/roadmap/">
          Roadmap
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/quick_start/" title="Quick Start" class="dd-item 
        parent
        
        
        ">
      <a href="/spring-cloud-alibaba/en/quick_start/">
          Quick Start
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/quick_start/nacos-discovery/" title="Nacos Discovery Example" class="dd-item 
        
        
        
        ">
      <a href="/spring-cloud-alibaba/en/quick_start/nacos-discovery/">
          Nacos Discovery Example
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/quick_start/nacos-config/" title="Nacos Config Example" class="dd-item 
        parent
        active
        
        ">
      <a href="/spring-cloud-alibaba/en/quick_start/nacos-config/">
          Nacos Config Example
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/quick_start/alicloud-storage/" title="Alicloud Storage Example" class="dd-item 
        
        
        
        ">
      <a href="/spring-cloud-alibaba/en/quick_start/alicloud-storage/">
          Alicloud Storage Example
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/spring-cloud-alibaba/en/quick_start/sentinel/" title="" class="dd-item 
        
        
        
        ">
      <a href="/spring-cloud-alibaba/en/quick_start/sentinel/">
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/spring-cloud-alibaba/en/quick_start/test/" title="" class="dd-item ">
        <a href="/spring-cloud-alibaba/en/quick_start/test/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba"><i class='fab fa-fw fa-github'></i> Github Repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://aliware-os.github.io/spring-cloud-alibaba/en/roadmaps"><i class='fas fa-fw fa-camera'></i> Roadmap</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-fw fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/spring-cloud-alibaba/en/quick_start/nacos-config/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="zh-cn" value="/spring-cloud-alibaba/zh-cn/quick_start/nacos-config/">简体中文</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/aliware-os/spring-cloud-alibaba/edit/master/content/quick_start/nacos-config/_index.en.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/spring-cloud-alibaba/en/'>Spring Cloud Alibaba</a> > <a href='/spring-cloud-alibaba/en/quick_start/'>Quick Start</a> > Nacos Config Example
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#project-instruction">Project Instruction</a></li>
<li><a href="#demo">Demo</a>
<ul>
<li><a href="#connect-to-nacos-config">Connect to Nacos Config</a></li>
<li><a href="#start-nacos-server">Start Nacos Server</a></li>
<li><a href="#start-application">Start Application</a></li>
<li><a href="#verification">Verification</a>
<ul>
<li><a href="#automatic-injection">Automatic Injection</a></li>
<li><a href="#dynamic-refresh">Dynamic Refresh</a></li>
</ul></li>
</ul></li>
<li><a href="#principle">Principle</a>
<ul>
<li><a href="#nacos-config-data-structure">Nacos Config Data Structure</a></li>
<li><a href="#spring-cloud-retrieve-data">Spring Cloud Retrieve Data</a>
<ul>
<li><a href="#dataid">dataID</a></li>
<li><a href="#group">group</a></li>
</ul></li>
<li><a href="#automatic-injection-1">Automatic Injection</a></li>
<li><a href="#dynamic-refresh-1">Dynamic Refresh</a></li>
</ul></li>
<li><a href="#endpoint">Endpoint</a></li>
<li><a href="#more">More</a>
<ul>
<li>
<ul>
<li><a href="#more-configuration-items">More configuration items</a></li>
<li><a href="#more-introduction">More introduction</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Nacos Config Example</h1>
          

        




<h2 id="project-instruction">Project Instruction</h2>

<p>This example illustrates how to use Nacos Config Starter implement externalized configuration for Spring Cloud applications.</p>

<p><a href="https://github.com/alibaba/Nacos">Nacos</a> an easy-to-use dynamic service discovery, configuration and service management platform for building cloud native applications.</p>

<h2 id="demo">Demo</h2>

<h3 id="connect-to-nacos-config">Connect to Nacos Config</h3>

<p>Before we start the demo, let&rsquo;s learn how to connect Nacos Config to a Spring Cloud application. <strong>Note: This section is to show you how to connect to Nacos Config. The configurations have been completed in the following example, so you don&rsquo;t need modify the code any more.</strong></p>

<ol>
<li><p>Add dependency spring-cloud-starter-alibaba-nacos-config in the pom.xml file in your Spring Cloud project.</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></li>

<li><p>Add Nacos server address configurations to file /src/main/resources/bootstrap.properties</p>

<pre><code>spring.cloud.nacos.config.server-addr=127.0.0.1:8080
</code></pre></li>

<li><p>After completing the above two steps, the application will get the externalized configuration from Nacos Server and put it in the Spring Environment&rsquo;s PropertySources.We use the @Value annotation to inject the corresponding configuration into the userName and age fields of the SampleController, and add @RefreshScope to turn on dynamic refresh .<br />
    @RefreshScope
    class SampleController {</p>

<pre><code>    @Value(&quot;${user.name}&quot;)
    String userName;

    @Value(&quot;${user.age}&quot;)
    int age;
}
</code></pre></li>
</ol>

<h3 id="start-nacos-server">Start Nacos Server</h3>

<ol>
<li><p>Install Nacos Server by downloading or build from source code.<strong>Recommended latest version Nacos Server</strong></p>

<ol>
<li>Download: Download Nacos Server <a href="https://github.com/alibaba/nacos/releases">download page</a></li>
<li>Build from source code: Get source code by git clone git@github.com:alibaba/Nacos.git from Github Nacos and build your code. See <a href="https://nacos.io/en-us/docs/quick-start.html">build reference</a> for details.
<br /></li>
</ol></li>

<li><p>Unzip the downloaded file and go to the nacos/bin folder(), And according to the actual situation of the operating system, execute the following command。<a href="https://nacos.io/en-us/docs/quick-start.html">see reference for more detail</a>。</p>

<ol>
<li>Linux/Unix/Mac , execute <code>sh startup.sh -m standalone</code></li>
<li>Windows , execute <code>cmd startup.cmd</code></li>
</ol></li>

<li><p>Execute the following command to add a configuration to Nacos Server.</p>

<pre><code>curl -X POST &quot;http://127.0.0.1:8080/nacos/v1/cs/configs?dataId=nacos-config-example.properties&amp;group=DEFAULT_GROUP&amp;content=user.id=1%0Auser.name=james%0Auser.age=17&quot;
</code></pre>

<p><strong>Note: You can also add it in other ways. If you are using the Nacos version with its own console, it is recommended to configure it directly using the console.</strong></p>

<p>Details of the added configuration are as follows</p>

<pre><code>dataId is nacos-config-example.properties
group is DEFAULT_GROUP

content is

    user.id=1
    user.name=james
    user.age=17 
</code></pre></li>
</ol>

<h3 id="start-application">Start Application</h3>

<ol>
<li><p>Add necessary configurations to file /src/main/resources/application.properties</p>

<pre><code>spring.application.name=nacos-config-example
server.port=18084
</code></pre></li>

<li><p>Start the application in IDE or by building a fatjar.</p>

<ol>
<li>Start in IDE: Find main class <code>Application</code>, and execute the main method.</li>
<li>Build a fatjar：Execute command <code>mvn clean package</code> to build a fatjar，and run command <code>java -jar nacos-config-example.jar</code> to start the application.</li>
</ol></li>
</ol>

<h3 id="verification">Verification</h3>

<h4 id="automatic-injection">Automatic Injection</h4>

<p>Enter <code>http://127.0.0.1:18084/user</code> in the browser address bar and click Go to, we can see the data successfully obtained from Nacos Config Server.</p>

<p><img src="https://cdn.nlark.com/lark/0/2018/png/54319/1536986328663-5e3503c2-7e14-4c56-b5f9-72fecc6898d2.png" alt="get" /></p>

<h4 id="dynamic-refresh">Dynamic Refresh</h4>

<ol>
<li><p>Run the following command to modify the configuration data on the Nacos Server side.</p>

<pre><code>curl -X POST &quot;http://127.0.0.1:8080/nacos/v1/cs/configs?dataId=nacos-config-example.properties&amp;group=DEFAULT_GROUP&amp;content=user.id=1%0Auser.name=james%0Auser.age=18&quot;
</code></pre></li>

<li><p>Enter <code>http://127.0.0.1:18084/user</code> in the browser address bar and click Go to,
We can see that the app got the latest data from Nacos Server and the age becomes 18.</p></li>
</ol>

<p><img src="https://cdn.nlark.com/lark/0/2018/png/54319/1536986336535-c0efdf6d-a5d3-4f33-8d26-fe3a36cdacf6.png" alt="refresh" /></p>

<h2 id="principle">Principle</h2>

<h3 id="nacos-config-data-structure">Nacos Config Data Structure</h3>

<p>Nacos Config primarily determines a piece of config through dataId and group, and we assume that you already know this background. If you don&rsquo;t understand, please refer to <a href="https://nacos.io/en-us/docs/concepts.html">Nacos Doc</a>。</p>

<p>Nacos Client gets data from Nacos Server through this method. <code>ConfigService.getConfig(String dataId, String group, long timeoutMs)</code>。</p>

<h3 id="spring-cloud-retrieve-data">Spring Cloud Retrieve Data</h3>

<h4 id="dataid">dataID</h4>

<p>In Nacos Config Starter, the splicing format of dataId is as follows</p>

<pre><code>${prefix} - ${spring.active.profile} . ${content-type}
</code></pre>

<ul>
<li><p><code>prefix</code> default value is <code>spring.application.name</code> value, which can also be configured via the configuration item <code>spring.cloud.nacos.config.prefix</code>.</p></li>

<li><p><code>spring.active.profile</code> is the profile corresponding to the current environment. For details, please refer to <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html#boot-features-profiles">Spring Boot Doc</a></p>

<p><strong>Note: when the activeprofile is empty, the corresponding connector <code>-</code> will also not exist, and the splicing format of the dataId becomes <code>${prefix}</code>.<code>${context.type}</code></strong></p></li>

<li><p><code>content-type</code> is the data format of the configuration content, which can be configured by the configuration item <code>spring.cloud.nacos.config.content-type</code>.
Currently only the <code>properties</code> type is supported.</p></li>
</ul>

<h4 id="group">group</h4>

<ul>
<li><code>group</code> defaults to <code>DEFAULT_GROUP</code> and can be configured via <code>spring.cloud.nacos.config.group</code>.</li>
</ul>

<h3 id="automatic-injection-1">Automatic Injection</h3>

<p>Nacos Config Starter implement <code>org.springframework.cloud.bootstrap.config.PropertySourceLocator</code> interface, and set order to 0.</p>

<p>In the startup phase of the Spring Cloud application, the corresponding data is obtained from the Nacos Server side, and the acquired data is converted into a PropertySource and injected into the PropertySources property of the Spring Environment. so the @Value annotation can also directly obtain the configuration of the Nacos Server side.</p>

<h3 id="dynamic-refresh-1">Dynamic Refresh</h3>

<p>By default, Nacos Config Starter adds a listening function to all Nacos configuration items that have successfully acquired data. It will trigger <code>org.springframework.cloud.context.refresh.ContextRefresher</code> &rsquo;s refresh method in real time when it detects changes in the server configuration.</p>

<p>If you need to dynamically refresh a bean, please refer to the Spring and Spring Cloud specifications. It is recommended to add <code>@RefreshScope</code> or <code>@ConfigurationProperties</code> annotations to the class.</p>

<p>Please refer to<a href="http://static.javadoc.io/org.springframework.cloud/spring-cloud-context/2.0.0.RELEASE/org/springframework/cloud/context/refresh/ContextRefresher.html">ContextRefresher Java Doc</a> for more details.</p>

<h2 id="endpoint">Endpoint</h2>

<p>Nacos Config starter also supports the implementation of Spring Boot actuator endpoints.</p>

<p><strong>Prerequisite:</strong></p>

<p>Add dependency spring-boot-starter-actuator to your pom.xml file, and configure your endpoint security strategy.</p>

<p>Spring Boot 1.x: Add configuration management.security.enabled=false
Spring Boot 2.x: Add configuration management.endpoints.web.exposure.include=*
To view the endpoint information, visit the following URLS:</p>

<p>Spring Boot1.x: Nacos Config  Endpoint URL is <a href="http://127.0.0.1:18083/nacos_config">http://127.0.0.1:18083/nacos_config</a>.
Spring Boot2.x: Nacos Config  Endpoint URL is <a href="http://127.0.0.1:18083/actuator/nacos-config">http://127.0.0.1:18083/actuator/nacos-config</a>.</p>

<p><img src="https://cdn.nlark.com/lark/0/2018/png/54319/1536986344822-279e1edc-ebca-4201-8362-0ddeff240b85.png" alt="actuator" /></p>

<p>As shown in the figure above, Sources indicates which Nacos Config configuration items the client has obtained information, RefreshHistory indicates the dynamic refresh history, and up to 20, and NacosConfigProperties is the configuration of Nacos Config Starter itself.</p>

<h2 id="more">More</h2>

<h4 id="more-configuration-items">More configuration items</h4>

<table>
<thead>
<tr>
<th>Configuration item</th>
<th>key</th>
<th>default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>server address</td>
<td>spring.cloud.nacos.config.server-addr</td>
<td></td>
<td></td>
</tr>

<tr>
<td>DataId prefix</td>
<td>spring.cloud.nacos.config.prefix</td>
<td></td>
<td>spring.application.name</td>
</tr>

<tr>
<td>Group</td>
<td>spring.cloud.nacos.config.group</td>
<td>DEFAULT_GROUP</td>
<td></td>
</tr>

<tr>
<td>dataID content type</td>
<td>spring.cloud.nacos.config.content-type</td>
<td>properties</td>
<td>currently only support properties</td>
</tr>

<tr>
<td>encoding</td>
<td>spring.cloud.nacos.config.encode</td>
<td>UTF-8</td>
<td>Content encoding</td>
</tr>

<tr>
<td>timeout</td>
<td>spring.cloud.nacos.config.timeout</td>
<td>3000</td>
<td>Get the configuration timeout period,unit is ms</td>
</tr>

<tr>
<td>namespace</td>
<td>spring.cloud.nacos.config.namespace</td>
<td></td>
<td>One of the common scenarios is the separation of the configuration of different environments, such as the development of the test environment and the resource isolation of the production environment.</td>
</tr>

<tr>
<td>AccessKey</td>
<td>spring.cloud.nacos.config.access-key</td>
<td></td>
<td></td>
</tr>

<tr>
<td>SecretKey</td>
<td>spring.cloud.nacos.config.secret-key</td>
<td></td>
<td></td>
</tr>

<tr>
<td>context-path</td>
<td>spring.cloud.nacos.config.context-path</td>
<td></td>
<td>Relative path of the server API</td>
</tr>

<tr>
<td>endpoint</td>
<td>spring.cloud.nacos.config.endpoint</td>
<td>UTF-8</td>
<td>The domain name of a service, through which the server address can be dynamically obtained.</td>
</tr>

<tr>
<td>refresh</td>
<td>spring.cloud.nacos.config.refresh.enabled</td>
<td>true</td>
<td>enable auto refresh</td>
</tr>
</tbody>
</table>

<h4 id="more-introduction">More introduction</h4>

<p><a href="https://github.com/alibaba/Nacos">Nacos</a> is committed to help you discover, configure, and manage your microservices. It provides a set of simple and useful features enabling you to realize dynamic service discovery, service configuration, service metadata and traffic management.</p>

<p>Nacos makes it easier and faster to construct, deliver and manage your microservices platform. It is the infrastructure that supports a service-centered modern application architecture with a microservices or cloud-native approach.</p>

<p>If you have any ideas or suggestions for Nacos Config starter, please don&rsquo;t hesitate to tell us by submitting github issues.</p>


<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/spring-cloud-alibaba/en/quick_start/nacos-discovery/" title="Nacos Discovery Example"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/spring-cloud-alibaba/en/quick_start/alicloud-storage/" title="Alicloud Storage Example" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/spring-cloud-alibaba/js/clipboard.min.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/perfect-scrollbar.min.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/perfect-scrollbar.jquery.min.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/jquery.sticky.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/featherlight.min.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/html5shiv-printshiv.min.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/highlight.pack.js?1542024317"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/spring-cloud-alibaba/js/modernizr.custom.71422.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/learn.js?1542024317"></script>
    <script src="/spring-cloud-alibaba/js/hugo-learn.js?1542024317"></script>

    <link href="/spring-cloud-alibaba/mermaid/mermaid.css?1542024317" type="text/css" rel="stylesheet" />
    <script src="/spring-cloud-alibaba/mermaid/mermaid.js?1542024317"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
